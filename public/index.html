<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>UP SHIP! - Airship Strategy Game</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Georgia', serif;
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
      min-height: 100vh;
      color: #e8e8e8;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .container {
      text-align: center;
      max-width: 800px;
    }

    h1 {
      font-size: 4rem;
      margin-bottom: 0.5rem;
      text-shadow: 3px 3px 6px rgba(0,0,0,0.5);
      letter-spacing: 0.2em;
    }

    .subtitle {
      font-size: 1.2rem;
      color: #c4a35a;
      margin-bottom: 2rem;
      font-style: italic;
    }

    .airship {
      font-size: 6rem;
      margin: 2rem 0;
      animation: float 3s ease-in-out infinite;
    }

    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-20px); }
    }

    .description {
      font-size: 1.1rem;
      line-height: 1.8;
      margin-bottom: 2rem;
      padding: 0 20px;
    }

    .status {
      background: rgba(255,255,255,0.1);
      border: 1px solid rgba(196, 163, 90, 0.5);
      border-radius: 8px;
      padding: 1.5rem 2rem;
      margin-top: 2rem;
    }

    .status h2 {
      color: #c4a35a;
      margin-bottom: 1rem;
      font-size: 1.3rem;
    }

    .factions {
      display: flex;
      justify-content: center;
      gap: 2rem;
      margin-top: 2rem;
      flex-wrap: wrap;
    }

    .faction {
      padding: 1rem;
      border-radius: 8px;
      background: rgba(255,255,255,0.05);
      min-width: 120px;
    }

    .faction-flag {
      font-size: 2rem;
      margin-bottom: 0.5rem;
    }

    .faction-name {
      font-size: 0.9rem;
      color: #c4a35a;
    }

    /* Auth UI */
    .auth-container {
      position: fixed;
      top: 20px;
      right: 20px;
      background: rgba(0,0,0,0.7);
      border: 1px solid rgba(196, 163, 90, 0.5);
      border-radius: 8px;
      padding: 1rem;
      min-width: 250px;
    }

    .auth-container h3 {
      color: #c4a35a;
      margin-bottom: 1rem;
      font-size: 1rem;
    }

    .auth-form {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .auth-form input {
      padding: 0.5rem;
      border: 1px solid rgba(196, 163, 90, 0.5);
      border-radius: 4px;
      background: rgba(255,255,255,0.1);
      color: #e8e8e8;
      font-size: 0.9rem;
    }

    .auth-form input::placeholder {
      color: #888;
    }

    .auth-form button {
      padding: 0.5rem 1rem;
      border: none;
      border-radius: 4px;
      background: #c4a35a;
      color: #1a1a2e;
      font-weight: bold;
      cursor: pointer;
      margin-top: 0.5rem;
    }

    .auth-form button:hover {
      background: #d4b36a;
    }

    .auth-tabs {
      display: flex;
      gap: 1rem;
      margin-bottom: 1rem;
    }

    .auth-tab {
      background: none;
      border: none;
      color: #888;
      cursor: pointer;
      padding: 0.25rem 0;
      border-bottom: 2px solid transparent;
    }

    .auth-tab.active {
      color: #c4a35a;
      border-bottom-color: #c4a35a;
    }

    .auth-error {
      color: #ff6b6b;
      font-size: 0.85rem;
      margin-top: 0.5rem;
    }

    .user-info {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .user-info .username {
      color: #c4a35a;
      font-weight: bold;
    }

    .user-info button {
      padding: 0.5rem 1rem;
      border: 1px solid #c4a35a;
      border-radius: 4px;
      background: transparent;
      color: #c4a35a;
      cursor: pointer;
    }

    .user-info button:hover {
      background: rgba(196, 163, 90, 0.2);
    }

    .hidden {
      display: none !important;
    }
  </style>
</head>
<body>
  <!-- Auth Container -->
  <div class="auth-container" id="authContainer">
    <!-- Login/Register Forms -->
    <div id="authForms">
      <div class="auth-tabs">
        <button class="auth-tab active" id="loginTab">Login</button>
        <button class="auth-tab" id="registerTab">Register</button>
      </div>

      <!-- Login Form -->
      <form class="auth-form" id="loginForm">
        <input type="text" name="username" placeholder="Username" required>
        <input type="password" name="password" placeholder="Password" required>
        <button type="submit">Login</button>
        <div class="auth-error hidden" id="loginError"></div>
      </form>

      <!-- Register Form -->
      <form class="auth-form hidden" id="registerForm">
        <input type="text" name="username" placeholder="Username (3-50 chars)" required>
        <input type="password" name="password" placeholder="Password (6+ chars)" required>
        <button type="submit">Register</button>
        <div class="auth-error hidden" id="registerError"></div>
      </form>
    </div>

    <!-- Logged In State -->
    <div class="user-info hidden" id="userInfo">
      <span>Welcome, <span class="username" id="displayName"></span></span>
      <button id="logoutBtn">Logout</button>
    </div>
  </div>

  <div class="container">
    <h1>UP SHIP!</h1>
    <p class="subtitle">The Golden Age of Airships (1900-1937)</p>

    <div class="airship">ðŸŽˆ</div>

    <p class="description">
      Command your airship conglomerate through three dramatic Ages of aviation history.
      Build legendary vessels, navigate treacherous routes, and outmaneuver your rivals
      in this strategic game of industrial ambition and aerial adventure.
    </p>

    <div class="factions">
      <div class="faction">
        <div class="faction-flag">ðŸ‡©ðŸ‡ª</div>
        <div class="faction-name">Germany</div>
      </div>
      <div class="faction">
        <div class="faction-flag">ðŸ‡¬ðŸ‡§</div>
        <div class="faction-name">Britain</div>
      </div>
      <div class="faction">
        <div class="faction-flag">ðŸ‡ºðŸ‡¸</div>
        <div class="faction-name">United States</div>
      </div>
      <div class="faction">
        <div class="faction-flag">ðŸ‡®ðŸ‡¹</div>
        <div class="faction-name">Italy</div>
      </div>
    </div>

    <div class="status">
      <h2>Development Status</h2>
      <p>Online implementation coming soon. Game design in progress.</p>
    </div>
  </div>

  <script>
    // Auth UI elements
    const authForms = document.getElementById('authForms');
    const userInfo = document.getElementById('userInfo');
    const loginForm = document.getElementById('loginForm');
    const registerForm = document.getElementById('registerForm');
    const loginTab = document.getElementById('loginTab');
    const registerTab = document.getElementById('registerTab');
    const loginError = document.getElementById('loginError');
    const registerError = document.getElementById('registerError');
    const displayName = document.getElementById('displayName');
    const logoutBtn = document.getElementById('logoutBtn');

    // Tab switching
    loginTab.addEventListener('click', () => {
      loginTab.classList.add('active');
      registerTab.classList.remove('active');
      loginForm.classList.remove('hidden');
      registerForm.classList.add('hidden');
      loginError.classList.add('hidden');
    });

    registerTab.addEventListener('click', () => {
      registerTab.classList.add('active');
      loginTab.classList.remove('active');
      registerForm.classList.remove('hidden');
      loginForm.classList.add('hidden');
      registerError.classList.add('hidden');
    });

    // Show logged in state
    function showLoggedIn(user) {
      authForms.classList.add('hidden');
      userInfo.classList.remove('hidden');
      displayName.textContent = user.displayName || user.username;
    }

    // Show login form
    function showLoginForm() {
      authForms.classList.remove('hidden');
      userInfo.classList.add('hidden');
      loginForm.reset();
      registerForm.reset();
    }

    // Login form submission
    loginForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      loginError.classList.add('hidden');

      const formData = new FormData(loginForm);
      const username = formData.get('username');
      const password = formData.get('password');

      try {
        const res = await fetch('/api/auth/login', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ username, password })
        });

        const data = await res.json();

        if (!res.ok) {
          loginError.textContent = data.error || 'Login failed';
          loginError.classList.remove('hidden');
          return;
        }

        showLoggedIn(data.user);
      } catch (err) {
        loginError.textContent = 'Network error';
        loginError.classList.remove('hidden');
      }
    });

    // Register form submission
    registerForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      registerError.classList.add('hidden');

      const formData = new FormData(registerForm);
      const username = formData.get('username');
      const password = formData.get('password');

      try {
        const res = await fetch('/api/auth/register', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ username, password })
        });

        const data = await res.json();

        if (!res.ok) {
          registerError.textContent = data.error || 'Registration failed';
          registerError.classList.remove('hidden');
          return;
        }

        showLoggedIn(data.user);
      } catch (err) {
        registerError.textContent = 'Network error';
        registerError.classList.remove('hidden');
      }
    });

    // Logout
    logoutBtn.addEventListener('click', async () => {
      try {
        await fetch('/api/auth/logout', { method: 'POST' });
        showLoginForm();
      } catch (err) {
        console.error('Logout error:', err);
      }
    });

    // Check auth status on page load
    async function checkAuth() {
      try {
        const res = await fetch('/api/auth/me');
        const data = await res.json();

        if (data.user) {
          showLoggedIn(data.user);
        } else {
          showLoginForm();
        }
      } catch (err) {
        console.error('Auth check error:', err);
        showLoginForm();
      }
    }

    // Initialize
    checkAuth();

    // Check API status
    fetch('/api/status')
      .then(res => res.json())
      .then(data => console.log('Server status:', data))
      .catch(err => console.error('API error:', err));
  </script>
</body>
</html>
